<!DOCTYPE html>
<html>
<head>
<title>supermatcher-admin-manual.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="supermatcher---administrator-manual">Supermatcher - Administrator Manual</h1>
<p><strong>Version 1.0.0</strong><br>
<strong>Production-Ready Fingerprint Authentication System</strong></p>
<hr>
<h2 id="table-of-contents">Table of Contents</h2>
<ol>
<li><a href="#1-system-overview">System Overview</a></li>
<li><a href="#2-system-requirements">System Requirements</a></li>
<li><a href="#3-installation">Installation</a></li>
<li><a href="#4-first-time-setup">First-Time Setup</a></li>
<li><a href="#5-starting-the-server">Starting the Server</a></li>
<li><a href="#6-configuration-reference">Configuration Reference</a></li>
<li><a href="#7-admin-dashboard-guide">Admin Dashboard Guide</a></li>
<li><a href="#8-backup-and-recovery">Backup and Recovery</a></li>
<li><a href="#9-monitoring-and-logs">Monitoring and Logs</a></li>
<li><a href="#10-troubleshooting">Troubleshooting</a></li>
<li><a href="#11-security-considerations">Security Considerations</a></li>
</ol>
<hr>
<h2 id="1-system-overview">1. System Overview</h2>
<p>The Supermatcher is a production-ready fingerprint authentication system with:</p>
<ul>
<li><strong>JWT-based authentication</strong> with role-based access control (admin/endpoint)</li>
<li><strong>Encrypted database</strong> (SQLCipher) for secure template storage</li>
<li><strong>Two-stage matching</strong>: Hash-based filtering + geometric verification</li>
<li><strong>Multi-sample enrollment</strong> with automatic template fusion</li>
<li><strong>Background job processing</strong> for batch operations</li>
<li><strong>Web-based interface</strong> for administration and testing</li>
</ul>
<h3 id="architecture">Architecture</h3>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Web Interface  â”‚ (Admin Dashboard / Endpoint Dashboard)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ HTTPS (JWT Auth)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   FastAPI       â”‚ (Routes + Authentication + Rate Limiting)
â”‚   WebServer     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚         â”‚          â”‚          â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â” â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚ Auth  â”‚ â”‚ User â”‚ â”‚ Biomet. â”‚ â”‚ Admin   â”‚
â”‚ Routesâ”‚ â”‚Routesâ”‚ â”‚ Routes  â”‚ â”‚ Routes  â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
    â”‚        â”‚           â”‚         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ ProcessPool Executor â”‚ (4-8 workers with CPU affinity)
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ Supermatcher v1.0   â”‚ (Fingerprint Pipeline)
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ SQLCipher Database  â”‚ (Encrypted storage)
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<hr>
<h2 id="2-system-requirements">2. System Requirements</h2>
<h3 id="hardware-requirements">Hardware Requirements</h3>
<ul>
<li><strong>CPU</strong>: Intel/AMD x64 with 4+ cores (6+ P-cores recommended for hybrid CPUs)</li>
<li><strong>RAM</strong>: 8 GB minimum, 16 GB recommended</li>
<li><strong>Storage</strong>: 10 GB minimum (database grows with enrollments)</li>
<li><strong>Network</strong>: Ethernet or WiFi with stable connection</li>
</ul>
<h3 id="software-requirements">Software Requirements</h3>
<ul>
<li>
<p><strong>Operating System</strong>:</p>
<ul>
<li>Windows 10/11 (64-bit)</li>
<li>Linux (Ubuntu 20.04+, Debian 11+, CentOS 8+)</li>
<li>macOS 11+ (limited testing)</li>
</ul>
</li>
<li>
<p><strong>Python</strong>: 3.8 or higher (3.10 recommended)</p>
</li>
<li>
<p><strong>Python Dependencies</strong> (installed via <code>requirements.txt</code>):</p>
<pre class="hljs"><code><div>uvicorn
cryptography
sqlcipher3-wheels
bcrypt
fastapi
numpy
opencv-python
scipy
pyjwt
psutil
pydantic
python-multipart
</div></code></pre>
</li>
</ul>
<hr>
<h2 id="3-installation">3. Installation</h2>
<h3 id="step-1-install-python">Step 1: Install Python</h3>
<p><strong>Windows:</strong></p>
<pre class="hljs"><code><div># Download from https://www.python.org/downloads/
# Run installer and check "Add Python to <span class="hljs-built_in">PATH</span>"
python --version
</div></code></pre>
<p><strong>Linux:</strong></p>
<pre class="hljs"><code><div>sudo apt update
sudo apt install python3.10 python3-pip
python3 --version
</div></code></pre>
<h3 id="step-2-clone-or-extract-project">Step 2: Clone or Extract Project</h3>
<pre class="hljs"><code><div><span class="hljs-built_in">cd</span> /path/to/installation
<span class="hljs-comment"># Project structure:</span>
biometric_system/
â”œâ”€â”€ run_webserver.py          <span class="hljs-comment"># Main startup script</span>
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ webserver/
â”‚   â”‚   â”œâ”€â”€ config.py         <span class="hljs-comment"># Configuration file</span>
â”‚   â”‚   â”œâ”€â”€ server.py
â”‚   â”‚   â”œâ”€â”€ database.py
â”‚   â”‚   â”œâ”€â”€ auth.py
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ frontend/
â”‚   â”œâ”€â”€ supermatcher_v1_0.py
â”‚   â””â”€â”€ ...
â””â”€â”€ logs/                     <span class="hljs-comment"># Created on first run</span>
</div></code></pre>
<h3 id="step-3-install-dependencies">Step 3: Install Dependencies</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Create virtual environment (recommended)</span>
python -m venv venv

<span class="hljs-comment"># Activate virtual environment</span>
<span class="hljs-comment"># Windows:</span>
venv\Scripts\activate
<span class="hljs-comment"># Linux/macOS:</span>
<span class="hljs-built_in">source</span> venv/bin/activate

<span class="hljs-comment"># Install dependencies</span>
pip install -r requirements.txt
</div></code></pre>
<h3 id="step-4-verify-installation">Step 4: Verify Installation</h3>
<pre class="hljs"><code><div>python -c <span class="hljs-string">"import cv2, numpy, fastapi; print('âœ“ All dependencies installed')"</span>
</div></code></pre>
<hr>
<h2 id="4-first-time-setup">4. First-Time Setup</h2>
<h3 id="interactive-setup">Interactive Setup</h3>
<p>Run the setup wizard:</p>
<pre class="hljs"><code><div>python run_webserver.py
</div></code></pre>
<p>The wizard will guide you through:</p>
<ol>
<li>
<p><strong>Admin Account Creation</strong></p>
<ul>
<li>Username: <code>admin</code> (default) or custom</li>
<li>Password: Minimum 8 characters</li>
<li>Privilege: <code>admin</code></li>
</ul>
</li>
<li>
<p><strong>Endpoint Account Creation</strong></p>
<ul>
<li>Username: <code>endpoint</code> (default) or custom</li>
<li>Password: Minimum 8 characters</li>
<li>Privilege: <code>endpoint</code></li>
</ul>
</li>
<li>
<p><strong>SSL Certificate Generation</strong></p>
<ul>
<li>Choose HTTPS (recommended) or HTTP</li>
<li>Default port: <code>8443</code> (HTTPS) or <code>8080</code> (HTTP)</li>
<li>Self-signed certificate generated automatically</li>
</ul>
</li>
</ol>
<h3 id="manual-setup-advanced">Manual Setup (Advanced)</h3>
<p>If you need to reset or manually configure:</p>
<pre class="hljs"><code><div><span class="hljs-comment"># Reset admin password</span>
python run_webserver.py --reset-admin

<span class="hljs-comment"># Delete database and start fresh</span>
rm biometric_system.db
rm .db_key
rm .jwt_secret
python run_webserver.py
</div></code></pre>
<hr>
<h2 id="5-starting-the-server">5. Starting the Server</h2>
<h3 id="basic-startup">Basic Startup</h3>
<pre class="hljs"><code><div>python run_webserver.py
</div></code></pre>
<p>Output:</p>
<pre class="hljs"><code><div>======================================================================
STARTING SUPERMATCHER WEBSERVER
======================================================================

ğŸ”’ HTTPS enabled with custom certificate
âœ“ Self-signed certificate generated
  âš ï¸  Browser will show security warning (normal for self-signed certs)

ğŸš€ Server starting on 0.0.0.0:8443
   Protocol: HTTPS
   Workers: 4

ğŸ“± Web Interface: https://localhost:8443/
ğŸ“š API Docs: https://localhost:8443/docs

Press CTRL+C to stop
======================================================================
</div></code></pre>
<h3 id="command-line-options">Command-Line Options</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Custom host and port</span>
python run_webserver.py --host 192.168.1.100 --port 8443

<span class="hljs-comment"># Use HTTP (not recommended for production)</span>
python run_webserver.py --ssl

<span class="hljs-comment"># Custom SSL certificates</span>
python run_webserver.py --cert /path/to/cert.pem --key /path/to/key.pem

<span class="hljs-comment"># More workers for high-load systems</span>
python run_webserver.py --workers 8

<span class="hljs-comment"># Reset admin password</span>
python run_webserver.py --reset-admin
</div></code></pre>
<h3 id="accessing-the-interface">Accessing the Interface</h3>
<ol>
<li>
<p><strong>Open browser</strong> and navigate to:</p>
<ul>
<li><code>https://localhost:8443/</code> (local access)</li>
<li><code>https://&lt;server-ip&gt;:8443/</code> (remote access)</li>
</ul>
</li>
<li>
<p><strong>Accept self-signed certificate warning</strong>:</p>
<ul>
<li>Chrome: Click &quot;Advanced&quot; â†’ &quot;Proceed to localhost&quot;</li>
<li>Firefox: Click &quot;Advanced&quot; â†’ &quot;Accept Risk&quot;</li>
<li>Edge: Click &quot;Advanced&quot; â†’ &quot;Continue to localhost&quot;</li>
</ul>
</li>
<li>
<p><strong>Login with admin account</strong>:</p>
<ul>
<li>Username: <code>admin</code></li>
<li>Password: (set during setup)</li>
</ul>
</li>
</ol>
<hr>
<h2 id="6-configuration-reference">6. Configuration Reference</h2>
<p>Edit <code>src/webserver/config.py</code> to customize system behavior.</p>
<h3 id="61-network-settings">6.1 Network Settings</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Server binding</span>
HOST = <span class="hljs-string">"0.0.0.0"</span>          <span class="hljs-comment"># Listen on all interfaces</span>
PORT_HTTPS = <span class="hljs-number">8443</span>         <span class="hljs-comment"># HTTPS port</span>
PORT_HTTP = <span class="hljs-number">8080</span>          <span class="hljs-comment"># HTTP fallback port</span>

<span class="hljs-comment"># CORS (Cross-Origin Resource Sharing)</span>
CORS_ORIGINS = [<span class="hljs-string">"*"</span>]      <span class="hljs-comment"># Allow all origins (restrict in production)</span>
</div></code></pre>
<p><strong>Recommendations:</strong></p>
<ul>
<li>For production, set <code>CORS_ORIGINS = [&quot;https://yourdomain.com&quot;]</code></li>
<li>Use <code>HOST = &quot;127.0.0.1&quot;</code> for local-only access</li>
</ul>
<h3 id="62-authentication-settings">6.2 Authentication Settings</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># JWT Token Expiry</span>
JWT_EXPIRY_ADMIN_HOURS = <span class="hljs-number">1</span>      <span class="hljs-comment"># Admin tokens expire in 1 hour</span>
JWT_EXPIRY_ENDPOINT_HOURS = <span class="hljs-number">12</span>  <span class="hljs-comment"># Endpoint tokens expire in 12 hours</span>

<span class="hljs-comment"># Account Lockout</span>
MAX_LOGIN_ATTEMPTS = <span class="hljs-number">5</span>          <span class="hljs-comment"># Lock account after 5 failed attempts</span>
LOCKOUT_DURATION_MINUTES = <span class="hljs-number">15</span>   <span class="hljs-comment"># Unlock after 15 minutes</span>
</div></code></pre>
<p><strong>Recommendations:</strong></p>
<ul>
<li>Keep admin token expiry short (1-2 hours) for security</li>
<li>Endpoint tokens can be longer (8-12 hours) for convenience</li>
<li>Adjust lockout settings based on security requirements</li>
</ul>
<h3 id="63-biometric-thresholds">6.3 Biometric Thresholds</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Quality Control</span>
QUALITY_THRESHOLD = <span class="hljs-number">0.30</span>        <span class="hljs-comment"># Minimum quality for enrollment (0.0-1.0)</span>

<span class="hljs-comment"># Matching Thresholds</span>
VERIFICATION_THRESHOLD = <span class="hljs-number">0.75</span>   <span class="hljs-comment"># 1:1 verification threshold</span>
IDENTIFICATION_THRESHOLD = <span class="hljs-number">0.70</span> <span class="hljs-comment"># 1:N identification threshold</span>
</div></code></pre>
<p><strong>Recommendations:</strong></p>
<ul>
<li>
<p><strong>Quality Threshold</strong>:</p>
<ul>
<li><code>0.30</code> = Balanced (recommended)</li>
<li><code>0.40</code> = Stricter (fewer false accepts, more rejections)</li>
<li><code>0.20</code> = Lenient (more users accepted, lower security)</li>
</ul>
</li>
<li>
<p><strong>Verification Threshold</strong>:</p>
<ul>
<li><code>0.75</code> = Balanced security (recommended)</li>
<li><code>0.80</code> = High security (fewer false accepts)</li>
<li><code>0.70</code> = Moderate security (fewer false rejects)</li>
</ul>
</li>
<li>
<p><strong>Identification Threshold</strong>:</p>
<ul>
<li><code>0.70</code> = Balanced (recommended)</li>
<li>Lower than verification to reduce false rejects in 1:N search</li>
</ul>
</li>
</ul>
<h3 id="64-enrollment-settings">6.4 Enrollment Settings</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Sample Requirements</span>
MIN_SAMPLES_PER_USER = <span class="hljs-number">2</span>        <span class="hljs-comment"># Minimum images required</span>
MAX_SAMPLES_PER_USER = <span class="hljs-number">10</span>       <span class="hljs-comment"># Maximum images allowed</span>
RECOMMENDED_SAMPLES = <span class="hljs-number">5</span>         <span class="hljs-comment"># Recommended for best accuracy</span>

<span class="hljs-comment"># Template Fusion</span>
FUSION_ENABLED = <span class="hljs-literal">True</span>           <span class="hljs-comment"># Enable multi-sample fusion</span>
FUSION_DISTANCE = <span class="hljs-number">12.0</span>          <span class="hljs-comment"># Pixel distance for minutiae matching</span>
FUSION_ANGLE_DEG = <span class="hljs-number">15.0</span>         <span class="hljs-comment"># Angle tolerance (degrees)</span>
FUSION_MIN_CONSENSUS = <span class="hljs-number">0.5</span>      <span class="hljs-comment"># Minimum consensus score (0.0-1.0)</span>
</div></code></pre>
<p><strong>Recommendations:</strong></p>
<ul>
<li><strong>Samples</strong>: 5 images per user provides best accuracy</li>
<li><strong>Fusion</strong>: Keep enabled for multi-sample enrollment</li>
<li>Don't modify fusion parameters unless you understand the algorithm</li>
</ul>
<h3 id="65-multiprocessing-settings">6.5 Multiprocessing Settings</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># ProcessPool Configuration</span>
MAX_WORKERS = <span class="hljs-number">4</span>                 <span class="hljs-comment"># Number of parallel workers</span>
USE_CPU_AFFINITY = <span class="hljs-literal">True</span>         <span class="hljs-comment"># Pin workers to specific cores</span>

<span class="hljs-comment"># Intel Hybrid CPU Configuration</span>
PCORES = list(range(<span class="hljs-number">0</span>, <span class="hljs-number">12</span>))     <span class="hljs-comment"># P-core logical threads (0-11)</span>
</div></code></pre>
<p><strong>Recommendations:</strong></p>
<ul>
<li>
<p><strong>MAX_WORKERS</strong>:</p>
<ul>
<li>Standard CPU: Set to number of physical cores</li>
<li>Hybrid CPU (Intel 12th+ gen): Set to number of P-cores Ã— 2</li>
<li>Example: 6 P-cores â†’ <code>MAX_WORKERS = 4-8</code></li>
</ul>
</li>
<li>
<p><strong>CPU_AFFINITY</strong>:</p>
<ul>
<li>Keep <code>True</code> for hybrid CPUs (pins to P-cores)</li>
<li>Set <code>False</code> for standard CPUs</li>
</ul>
</li>
</ul>
<h3 id="66-rate-limiting">6.6 Rate Limiting</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Rate Limits: (max_requests, time_window_seconds)</span>
RATE_LIMITS = {
    <span class="hljs-string">"login"</span>: (<span class="hljs-number">5</span>, <span class="hljs-number">300</span>),          <span class="hljs-comment"># 5 login attempts per 5 minutes</span>
    <span class="hljs-string">"verify"</span>: (<span class="hljs-number">10</span>, <span class="hljs-number">60</span>),         <span class="hljs-comment"># 10 verifications per minute</span>
    <span class="hljs-string">"identify"</span>: (<span class="hljs-number">5</span>, <span class="hljs-number">60</span>),        <span class="hljs-comment"># 5 identifications per minute</span>
    <span class="hljs-string">"enroll"</span>: (<span class="hljs-number">20</span>, <span class="hljs-number">3600</span>),       <span class="hljs-comment"># 20 enrollments per hour</span>
    <span class="hljs-string">"update"</span>: (<span class="hljs-number">10</span>, <span class="hljs-number">3600</span>),       <span class="hljs-comment"># 10 updates per hour</span>
    <span class="hljs-string">"delete"</span>: (<span class="hljs-number">30</span>, <span class="hljs-number">3600</span>),       <span class="hljs-comment"># 30 deletes per hour</span>
}
</div></code></pre>
<p><strong>Recommendations:</strong></p>
<ul>
<li>Adjust based on expected usage patterns</li>
<li>Stricter limits improve security but may impact usability</li>
<li>Monitor logs to identify if limits are too restrictive</li>
</ul>
<h3 id="67-logging-settings">6.7 Logging Settings</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># Log Files</span>
LOG_DIR = PROJECT_ROOT / <span class="hljs-string">"logs"</span>
LOG_ACCESS = LOG_DIR / <span class="hljs-string">"access.log"</span>     <span class="hljs-comment"># HTTP requests</span>
LOG_AUTH = LOG_DIR / <span class="hljs-string">"auth.log"</span>         <span class="hljs-comment"># Authentication events</span>
LOG_BIOMETRIC = LOG_DIR / <span class="hljs-string">"biometric.log"</span>  <span class="hljs-comment"># Biometric operations</span>
LOG_ERROR = LOG_DIR / <span class="hljs-string">"error.log"</span>       <span class="hljs-comment"># Application errors</span>

<span class="hljs-comment"># Rotation Settings</span>
LOG_MAX_BYTES = <span class="hljs-number">10</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>       <span class="hljs-comment"># 10MB per file</span>
LOG_BACKUP_COUNT = <span class="hljs-number">5</span>                    <span class="hljs-comment"># Keep 5 backup files</span>
</div></code></pre>
<hr>
<h2 id="7-admin-dashboard-guide">7. Admin Dashboard Guide</h2>
<h3 id="71-dashboard-overview">7.1 Dashboard Overview</h3>
<p>After logging in as admin, you'll see:</p>
<pre class="hljs"><code><div>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘‘ Admin Dashboard                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Statistics:                                    â”‚
â”‚   ğŸ‘¥ Total Users: 42                           â”‚
â”‚   ğŸ“Š Avg Quality: 85.3%                        â”‚
â”‚   ğŸ” Database: Encrypted âœ“                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Quick Actions:                                 â”‚
â”‚  [â• Add User] [ğŸ“‚ Load Folder] [ğŸ” Verify]   â”‚
â”‚  [ğŸ¯ Identify] [ğŸ”„ Refresh List] [ğŸ—‘ï¸ Delete All]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Enrolled Users (table)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Real-time Updates (log)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<h3 id="72-add-user-single-enrollment">7.2 Add User (Single Enrollment)</h3>
<p><strong>Steps:</strong></p>
<ol>
<li>
<p>Click <strong>&quot;â• Add User&quot;</strong></p>
</li>
<li>
<p>Fill in form:</p>
<ul>
<li><strong>User ID</strong>: Unique identifier (e.g., <code>user001</code>, <code>employee_123</code>)</li>
<li><strong>Name</strong>: Full name (e.g., <code>John Doe</code>)</li>
<li><strong>Images</strong>: Upload 2-10 fingerprint images (5 recommended)</li>
</ul>
</li>
<li>
<p>Click <strong>&quot;Add User&quot;</strong></p>
</li>
<li>
<p>Wait for processing (2-10 seconds per user)</p>
</li>
<li>
<p>View result:</p>
<ul>
<li>âœ“ Success: User enrolled with quality score</li>
<li>âœ— Error: Quality too low or processing failed</li>
</ul>
</li>
</ol>
<p><strong>Tips:</strong></p>
<ul>
<li>Use consistent user ID format (e.g., <code>USER_001</code>, <code>EMP_0123</code>)</li>
<li>Capture fingerprints with good lighting and clean scanner</li>
<li>5 samples provide best accuracy (minimum 2 required)</li>
</ul>
<h3 id="73-load-folder-batch-enrollment">7.3 Load Folder (Batch Enrollment)</h3>
<p><strong>Folder Structure:</strong></p>
<p>The system supports two folder structures:</p>
<p><strong>Option A: Flat Structure</strong> (recommended for standard databases)</p>
<pre class="hljs"><code><div>folder_path/
  101_1.tif
  101_2.tif
  101_3.tif
  ...
  101_8.tif
  102_1.tif
  102_2.tif
  ...
</div></code></pre>
<p><strong>Option B: Subfolder Structure</strong></p>
<pre class="hljs"><code><div>folder_path/
  user001/
    img1.png
    img2.png
    img3.png
  user002/
    img1.png
    img2.png
</div></code></pre>
<p><strong>Steps:</strong></p>
<ol>
<li>
<p>Click <strong>&quot;ğŸ“‚ Load Folder&quot;</strong></p>
</li>
<li>
<p>Enter folder path:</p>
<ul>
<li>Windows: <code>C:/fingerprints</code> or <code>C:\\fingerprints</code></li>
<li>Linux: <code>/home/user/fingerprints</code></li>
</ul>
</li>
<li>
<p>Click <strong>&quot;ğŸ” Load Folder&quot;</strong></p>
</li>
<li>
<p>Background job starts:</p>
<ul>
<li>Progress shown in real-time</li>
<li>Can navigate away and check back later</li>
</ul>
</li>
<li>
<p>View results:</p>
<ul>
<li>âœ… Enrolled: X users</li>
<li>âš ï¸ Skipped: Y users (already exist)</li>
<li>âŒ Errors: Z users (quality too low or file errors)</li>
</ul>
</li>
</ol>
<p><strong>Tips:</strong></p>
<ul>
<li>Minimum 5 images per user required</li>
<li>All images processed (no maximum limit)</li>
<li>Existing users are automatically skipped</li>
<li>Large batches (100+ users) may take 10-30 minutes</li>
</ul>
<h3 id="74-verify-11-matching">7.4 Verify (1:1 Matching)</h3>
<p><strong>Steps:</strong></p>
<ol>
<li>Click <strong>&quot;ğŸ” Verify&quot;</strong></li>
<li>Enter <strong>User ID</strong> to verify against</li>
<li>Upload <strong>probe fingerprint image</strong></li>
<li>Click <strong>&quot;Verify&quot;</strong></li>
<li>View result:
<ul>
<li>âœ“ <strong>VERIFIED</strong>: Score â‰¥ 75% (threshold)</li>
<li>âœ— <strong>NOT VERIFIED</strong>: Score &lt; 75%</li>
</ul>
</li>
</ol>
<p><strong>Interpretation:</strong></p>
<ul>
<li><strong>Score</strong>: Combined hash + geometric similarity</li>
<li><strong>Threshold</strong>: 75% (configurable in <code>config.py</code>)</li>
<li><strong>Use Case</strong>: Authenticate claimed identity</li>
</ul>
<h3 id="75-identify-1n-matching">7.5 Identify (1:N Matching)</h3>
<p><strong>Steps:</strong></p>
<ol>
<li>Click <strong>&quot;ğŸ¯ Identify&quot;</strong></li>
<li>Upload <strong>probe fingerprint image</strong></li>
<li>Click <strong>&quot;Identify&quot;</strong></li>
<li>View result:
<ul>
<li>âœ“ <strong>IDENTIFIED</strong>: Best match with User ID and score</li>
<li>âœ— <strong>NOT IDENTIFIED</strong>: No match above threshold</li>
</ul>
</li>
</ol>
<p><strong>Interpretation:</strong></p>
<ul>
<li><strong>Best Match</strong>: Highest scoring user in database</li>
<li><strong>Score</strong>: Combined hash + geometric similarity</li>
<li><strong>Threshold</strong>: 70% (configurable in <code>config.py</code>)</li>
<li><strong>Use Case</strong>: Search unknown fingerprint against database</li>
</ul>
<h3 id="76-update-user">7.6 Update User</h3>
<p><strong>Steps:</strong></p>
<ol>
<li>
<p>Find user in &quot;Enrolled Users&quot; table</p>
</li>
<li>
<p>Click <strong>&quot;Edit&quot;</strong> button</p>
</li>
<li>
<p>Modify:</p>
<ul>
<li><strong>Name</strong>: Update user's name</li>
<li><strong>Images</strong>: Upload new fingerprint images (re-enrollment)</li>
</ul>
</li>
<li>
<p>Click <strong>&quot;Update&quot;</strong></p>
</li>
<li>
<p>Template regenerated if new images provided</p>
</li>
</ol>
<h3 id="77-delete-user">7.7 Delete User</h3>
<p><strong>Steps:</strong></p>
<ol>
<li>Find user in &quot;Enrolled Users&quot; table</li>
<li>Click <strong>&quot;Delete&quot;</strong> button</li>
<li>Confirm deletion (âš ï¸ cannot be undone)</li>
<li>User removed from database and cache</li>
</ol>
<h3 id="78-delete-all-users">7.8 Delete All Users</h3>
<p><strong>âš ï¸ WARNING: This operation deletes ALL enrolled users!</strong></p>
<p><strong>Steps:</strong></p>
<ol>
<li>Click <strong>&quot;ğŸ—‘ï¸ Delete All&quot;</strong></li>
<li>Confirm (âš ï¸ cannot be undone)</li>
<li>All users deleted from database</li>
<li>Template cache cleared</li>
</ol>
<p><strong>Use Case:</strong> Testing, database reset, or complete system reset</p>
<hr>
<h2 id="8-backup-and-recovery">8. Backup and Recovery</h2>
<h3 id="81-what-to-backup">8.1 What to Backup</h3>
<p><strong>Critical Files:</strong></p>
<pre class="hljs"><code><div>biometric_system/
â”œâ”€â”€ biometric_system.db       # Main database (contains all users)
â”œâ”€â”€ .db_key                   # Database encryption key
â”œâ”€â”€ .jwt_secret               # JWT signing key
â””â”€â”€ certs/
    â”œâ”€â”€ self-signed-cert.pem  # SSL certificate
    â””â”€â”€ self-signed-key.pem   # SSL private key
</div></code></pre>
<p><strong>Optional Files:</strong></p>
<pre class="hljs"><code><div>logs/                         # System logs (for troubleshooting)
  â”œâ”€â”€ access.log
  â”œâ”€â”€ auth.log
  â”œâ”€â”€ biometric.log
  â””â”€â”€ error.log
</div></code></pre>
<h3 id="82-backup-procedure">8.2 Backup Procedure</h3>
<p><strong>Windows:</strong></p>
<pre class="hljs"><code><div># Stop the server first (CTRL+C)

# Create backup folder
<span class="hljs-built_in">mkdir</span> backups\<span class="hljs-variable">%date:~-4,4%</span><span class="hljs-variable">%date:~-7,2%</span><span class="hljs-variable">%date:~-10,2%</span>

# <span class="hljs-built_in">Copy</span> critical files
<span class="hljs-built_in">copy</span> biometric_system.db backups\<span class="hljs-variable">%date:~-4,4%</span><span class="hljs-variable">%date:~-7,2%</span><span class="hljs-variable">%date:~-10,2%</span>\
<span class="hljs-built_in">copy</span> .db_key backups\<span class="hljs-variable">%date:~-4,4%</span><span class="hljs-variable">%date:~-7,2%</span><span class="hljs-variable">%date:~-10,2%</span>\
<span class="hljs-built_in">copy</span> .jwt_secret backups\<span class="hljs-variable">%date:~-4,4%</span><span class="hljs-variable">%date:~-7,2%</span><span class="hljs-variable">%date:~-10,2%</span>\
<span class="hljs-built_in">xcopy</span> /E /I certs backups\<span class="hljs-variable">%date:~-4,4%</span><span class="hljs-variable">%date:~-7,2%</span><span class="hljs-variable">%date:~-10,2%</span>\certs
</div></code></pre>
<p><strong>Linux:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Stop the server first (CTRL+C)</span>

<span class="hljs-comment"># Create backup folder</span>
mkdir -p backups/$(date +%Y%m%d)

<span class="hljs-comment"># Copy critical files</span>
cp biometric_system.db backups/$(date +%Y%m%d)/
cp .db_key backups/$(date +%Y%m%d)/
cp .jwt_secret backups/$(date +%Y%m%d)/
cp -r certs backups/$(date +%Y%m%d)/
</div></code></pre>
<p><strong>Automated Backup Script</strong> (Linux/cron):</p>
<pre class="hljs"><code><div><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># Save as: backup_biometric.sh</span>

BACKUP_DIR=<span class="hljs-string">"/path/to/backups"</span>
DATE=$(date +%Y%m%d_%H%M%S)

mkdir -p <span class="hljs-string">"<span class="hljs-variable">$BACKUP_DIR</span>/<span class="hljs-variable">$DATE</span>"</span>
cp biometric_system.db <span class="hljs-string">"<span class="hljs-variable">$BACKUP_DIR</span>/<span class="hljs-variable">$DATE</span>/"</span>
cp .db_key <span class="hljs-string">"<span class="hljs-variable">$BACKUP_DIR</span>/<span class="hljs-variable">$DATE</span>/"</span>
cp .jwt_secret <span class="hljs-string">"<span class="hljs-variable">$BACKUP_DIR</span>/<span class="hljs-variable">$DATE</span>/"</span>
cp -r certs <span class="hljs-string">"<span class="hljs-variable">$BACKUP_DIR</span>/<span class="hljs-variable">$DATE</span>/"</span>

<span class="hljs-comment"># Keep only last 30 days</span>
find <span class="hljs-string">"<span class="hljs-variable">$BACKUP_DIR</span>"</span> -<span class="hljs-built_in">type</span> d -mtime +30 -<span class="hljs-built_in">exec</span> rm -rf {} +
</div></code></pre>
<p>Add to crontab:</p>
<pre class="hljs"><code><div><span class="hljs-comment"># Daily backup at 2 AM</span>
0 2 * * * /path/to/backup_biometric.sh
</div></code></pre>
<h3 id="83-recovery-procedure">8.3 Recovery Procedure</h3>
<p><strong>Steps:</strong></p>
<ol>
<li>
<p><strong>Stop the server</strong> (if running)</p>
</li>
<li>
<p><strong>Restore files:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Replace current files with backup</span>
cp backups/20250115/biometric_system.db .
cp backups/20250115/.db_key .
cp backups/20250115/.jwt_secret .
cp -r backups/20250115/certs .
</div></code></pre>
</li>
<li>
<p><strong>Verify file permissions:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Linux</span>
chmod 600 .db_key .jwt_secret
chmod 600 certs/*.pem
</div></code></pre>
</li>
<li>
<p><strong>Start the server:</strong></p>
<pre class="hljs"><code><div>python run_webserver.py
</div></code></pre>
</li>
<li>
<p><strong>Verify data:</strong></p>
<ul>
<li>Login to admin dashboard</li>
<li>Check user count matches backup</li>
<li>Test verify/identify operations</li>
</ul>
</li>
</ol>
<hr>
<h2 id="9-monitoring-and-logs">9. Monitoring and Logs</h2>
<h3 id="91-log-files">9.1 Log Files</h3>
<p>All logs are stored in <code>logs/</code> directory:</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Contents</th>
<th>Use Case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>access.log</code></td>
<td>HTTP requests (IP, endpoint, status, duration)</td>
<td>Monitor API usage, detect anomalies</td>
</tr>
<tr>
<td><code>auth.log</code></td>
<td>Authentication events (login, logout, failures)</td>
<td>Security auditing, detect brute-force attacks</td>
</tr>
<tr>
<td><code>biometric.log</code></td>
<td>Biometric operations (enroll, verify, identify)</td>
<td>Track system usage, performance analysis</td>
</tr>
<tr>
<td><code>error.log</code></td>
<td>Application errors and exceptions</td>
<td>Troubleshooting, debugging</td>
</tr>
</tbody>
</table>
<h3 id="92-log-format">9.2 Log Format</h3>
<p><strong>access.log:</strong></p>
<pre class="hljs"><code><div>2025-01-15 14:23:45,123 [INFO] webserver.access: 192.168.1.100 - POST /api/verify - 200 - 2340.56ms user=endpoint
</div></code></pre>
<p><strong>auth.log:</strong></p>
<pre class="hljs"><code><div>2025-01-15 14:23:30,456 [INFO] webserver.auth: LOGIN SUCCESS - login=admin ip=192.168.1.100
</div></code></pre>
<p><strong>biometric.log:</strong></p>
<pre class="hljs"><code><div>2025-01-15 14:23:45,789 [INFO] webserver.biometric: VERIFY MATCH - user_id=user001 by=endpoint - score=0.82, num_matched=34
</div></code></pre>
<p><strong>error.log:</strong></p>
<pre class="hljs"><code><div>2025-01-15 14:24:01,234 [ERROR] webserver.error: ValueError: Quality too low: 0.25 &lt; 0.30 in /api/users user=admin
</div></code></pre>
<h3 id="93-monitoring-commands">9.3 Monitoring Commands</h3>
<p><strong>View live logs:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Linux</span>
tail -f logs/access.log
tail -f logs/biometric.log

<span class="hljs-comment"># Windows (PowerShell)</span>
Get-Content logs\access.log -Wait -Tail 50
</div></code></pre>
<p><strong>Search logs:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Find all failed logins</span>
grep <span class="hljs-string">"LOGIN FAILED"</span> logs/auth.log

<span class="hljs-comment"># Find verifications for specific user</span>
grep <span class="hljs-string">"user_id=user001"</span> logs/biometric.log

<span class="hljs-comment"># Find errors in last hour</span>
find logs/error.log -mmin -60 -<span class="hljs-built_in">exec</span> cat {} \;
</div></code></pre>
<p><strong>Log rotation:</strong></p>
<ul>
<li>Logs automatically rotate at 10MB per file</li>
<li>Keeps 5 backup files (e.g., <code>access.log.1</code>, <code>access.log.2</code>, ...)</li>
<li>Total log storage: ~50MB per log type</li>
</ul>
<h3 id="94-system-health-check">9.4 System Health Check</h3>
<p><strong>Check server status:</strong></p>
<pre class="hljs"><code><div>curl -k https://localhost:8443/health
</div></code></pre>
<p>Response:</p>
<pre class="hljs"><code><div>{
  <span class="hljs-attr">"status"</span>: <span class="hljs-string">"healthy"</span>,
  <span class="hljs-attr">"cached_templates"</span>: <span class="hljs-number">42</span>,
  <span class="hljs-attr">"max_workers"</span>: <span class="hljs-number">4</span>,
  <span class="hljs-attr">"running_jobs"</span>: <span class="hljs-number">0</span>
}
</div></code></pre>
<p><strong>Check database:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Count enrolled users</span>
python -c <span class="hljs-string">"from src.webserver.database import BiometricDatabase; db = BiometricDatabase(); print(f'Users: {len(db.list_fingerprints())}'); db.close()"</span>
</div></code></pre>
<hr>
<h2 id="10-troubleshooting">10. Troubleshooting</h2>
<h3 id="101-server-wont-start">10.1 Server Won't Start</h3>
<p><strong>Issue: &quot;Port already in use&quot;</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Find process using port 8443</span>
<span class="hljs-comment"># Linux:</span>
sudo lsof -i :8443
<span class="hljs-comment"># Windows:</span>
netstat -ano | findstr :8443

<span class="hljs-comment"># Kill the process or use different port</span>
python run_webserver.py --port 9443
</div></code></pre>
<p><strong>Issue: &quot;Module not found&quot;</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Reinstall dependencies</span>
pip install -r requirements.txt --force-reinstall

<span class="hljs-comment"># Verify installation</span>
pip list
</div></code></pre>
<p><strong>Issue: &quot;Database locked&quot;</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Another process is using the database</span>
<span class="hljs-comment"># Find and stop it:</span>
ps aux | grep run_webserver.py  <span class="hljs-comment"># Linux</span>
tasklist | findstr python        <span class="hljs-comment"># Windows</span>

<span class="hljs-comment"># If persistent, remove lock file:</span>
rm biometric_system.db-journal
</div></code></pre>
<h3 id="102-ssl-certificate-errors">10.2 SSL Certificate Errors</h3>
<p><strong>Issue: Browser shows &quot;Not Secure&quot;</strong></p>
<p>This is <strong>normal</strong> for self-signed certificates. Options:</p>
<ol>
<li><strong>Accept the warning</strong> (click &quot;Advanced&quot; â†’ &quot;Proceed&quot;)</li>
<li><strong>Add exception</strong> in browser settings</li>
<li><strong>Use production certificate</strong> (e.g., Let's Encrypt):<pre class="hljs"><code><div>python run_webserver.py --cert /path/to/fullchain.pem --key /path/to/privkey.pem
</div></code></pre>
</li>
</ol>
<p><strong>Issue: &quot;Certificate verification failed&quot;</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Regenerate self-signed certificate</span>
rm -rf certs/
python run_webserver.py
</div></code></pre>
<h3 id="103-authentication-issues">10.3 Authentication Issues</h3>
<p><strong>Issue: &quot;Invalid credentials&quot;</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Reset admin password</span>
python run_webserver.py --reset-admin
</div></code></pre>
<p><strong>Issue: &quot;Token has expired&quot;</strong></p>
<ul>
<li>Normal behavior after configured expiry time</li>
<li>Re-login to get new token</li>
<li>Adjust expiry in <code>config.py</code>:<pre class="hljs"><code><div>JWT_EXPIRY_ADMIN_HOURS = <span class="hljs-number">2</span>  <span class="hljs-comment"># Increase from 1 to 2 hours</span>
</div></code></pre>
</li>
</ul>
<p><strong>Issue: &quot;IP locked out&quot;</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Wait 15 minutes or restart server to clear lockout</span>
<span class="hljs-comment"># Adjust lockout settings in config.py:</span>
MAX_LOGIN_ATTEMPTS = 10      <span class="hljs-comment"># Increase from 5</span>
LOCKOUT_DURATION_MINUTES = 5 <span class="hljs-comment"># Decrease from 15</span>
</div></code></pre>
<h3 id="104-enrollment-failures">10.4 Enrollment Failures</h3>
<p><strong>Issue: &quot;Quality too low&quot;</strong></p>
<p><strong>Causes:</strong></p>
<ul>
<li>Poor image quality (blur, noise)</li>
<li>Incorrect fingerprint placement</li>
<li>Scanner issues</li>
</ul>
<p><strong>Solutions:</strong></p>
<ul>
<li>Clean fingerprint scanner</li>
<li>Ensure good lighting</li>
<li>Capture multiple clear samples</li>
<li>Lower quality threshold (not recommended for production):<pre class="hljs"><code><div>QUALITY_THRESHOLD = <span class="hljs-number">0.25</span>  <span class="hljs-comment"># Default: 0.30</span>
</div></code></pre>
</li>
</ul>
<p><strong>Issue: &quot;No minutiae extracted&quot;</strong></p>
<p><strong>Causes:</strong></p>
<ul>
<li>Extremely low quality image</li>
<li>Incompatible image format</li>
<li>Corrupted file</li>
</ul>
<p><strong>Solutions:</strong></p>
<ul>
<li>Use standard formats (PNG, JPG, TIF)</li>
<li>Re-capture fingerprint</li>
<li>Verify image can be opened in image viewer</li>
</ul>
<p><strong>Issue: &quot;User already exists&quot;</strong></p>
<ul>
<li>User ID must be unique</li>
<li>Delete existing user first or use different ID</li>
</ul>
<h3 id="105-matching-issues">10.5 Matching Issues</h3>
<p><strong>Issue: &quot;False rejects (legitimate user not verified)&quot;</strong></p>
<p><strong>Causes:</strong></p>
<ul>
<li>Threshold too high</li>
<li>Poor enrollment quality</li>
<li>Probe image quality low</li>
</ul>
<p><strong>Solutions:</strong></p>
<ul>
<li>Lower thresholds in <code>config.py</code>:<pre class="hljs"><code><div>VERIFICATION_THRESHOLD = <span class="hljs-number">0.70</span>   <span class="hljs-comment"># Default: 0.75</span>
IDENTIFICATION_THRESHOLD = <span class="hljs-number">0.65</span> <span class="hljs-comment"># Default: 0.70</span>
</div></code></pre>
</li>
<li>Re-enroll user with better quality samples</li>
<li>Ensure consistent capture conditions</li>
</ul>
<p><strong>Issue: &quot;False accepts (wrong user verified)&quot;</strong></p>
<p><strong>Causes:</strong></p>
<ul>
<li>Threshold too low</li>
<li>Similar fingerprints in database</li>
<li>Quality threshold too low during enrollment</li>
</ul>
<p><strong>Solutions:</strong></p>
<ul>
<li>Increase thresholds:<pre class="hljs"><code><div>VERIFICATION_THRESHOLD = <span class="hljs-number">0.80</span>   <span class="hljs-comment"># Default: 0.75</span>
QUALITY_THRESHOLD = <span class="hljs-number">0.35</span>        <span class="hljs-comment"># Default: 0.30</span>
</div></code></pre>
</li>
<li>Review enrolled users for duplicates</li>
<li>Re-enroll with stricter quality control</li>
</ul>
<h3 id="106-performance-issues">10.6 Performance Issues</h3>
<p><strong>Issue: &quot;Slow enrollment/identification&quot;</strong></p>
<p><strong>Causes:</strong></p>
<ul>
<li>Insufficient CPU resources</li>
<li>Too many workers competing for resources</li>
<li>Large database (1000+ users)</li>
</ul>
<p><strong>Solutions:</strong></p>
<ul>
<li>Adjust worker count:<pre class="hljs"><code><div>MAX_WORKERS = <span class="hljs-number">8</span>  <span class="hljs-comment"># Increase for more parallelism</span>
</div></code></pre>
</li>
<li>Enable CPU affinity on hybrid CPUs:<pre class="hljs"><code><div>USE_CPU_AFFINITY = <span class="hljs-literal">True</span>
PCORES = list(range(<span class="hljs-number">0</span>, <span class="hljs-number">12</span>))  <span class="hljs-comment"># Adjust for your CPU</span>
</div></code></pre>
</li>
<li>Monitor CPU usage during operations</li>
</ul>
<p><strong>Issue: &quot;High memory usage&quot;</strong></p>
<p><strong>Causes:</strong></p>
<ul>
<li>Large template cache</li>
<li>Many concurrent operations</li>
</ul>
<p><strong>Solutions:</strong></p>
<ul>
<li>Monitor with <code>htop</code> (Linux) or Task Manager (Windows)</li>
<li>Reduce worker count if memory limited:<pre class="hljs"><code><div>MAX_WORKERS = <span class="hljs-number">2</span>  <span class="hljs-comment"># Reduce from 4</span>
</div></code></pre>
</li>
</ul>
<hr>
<h2 id="11-security-considerations">11. Security Considerations</h2>
<h3 id="111-production-deployment-checklist">11.1 Production Deployment Checklist</h3>
<ul>
<li><input type="checkbox" id="checkbox0"><label for="checkbox0"></label><strong>Use production SSL certificate</strong> (not self-signed)</li>
<li><input type="checkbox" id="checkbox1"><label for="checkbox1"></label><strong>Change default passwords</strong> for admin and endpoint accounts</li>
<li><input type="checkbox" id="checkbox2"><label for="checkbox2"></label><strong>Restrict CORS origins</strong> in <code>config.py</code>:<pre class="hljs"><code><div>CORS_ORIGINS = [<span class="hljs-string">"https://yourdomain.com"</span>]
</div></code></pre>
</li>
<li><input type="checkbox" id="checkbox3"><label for="checkbox3"></label><strong>Enable firewall rules</strong> to restrict access:<pre class="hljs"><code><div><span class="hljs-comment"># Linux (ufw)</span>
sudo ufw allow from 192.168.1.0/24 to any port 8443

<span class="hljs-comment"># Windows Firewall</span>
<span class="hljs-comment"># Add inbound rule for port 8443, specific IP range</span>
</div></code></pre>
</li>
<li><input type="checkbox" id="checkbox4"><label for="checkbox4"></label><strong>Set strong rate limits</strong> for production</li>
<li><input type="checkbox" id="checkbox5"><label for="checkbox5"></label><strong>Enable automated backups</strong> (daily recommended)</li>
<li><input type="checkbox" id="checkbox6"><label for="checkbox6"></label><strong>Monitor logs</strong> for suspicious activity</li>
<li><input type="checkbox" id="checkbox7"><label for="checkbox7"></label><strong>Keep software updated</strong> (Python, dependencies, OS)</li>
<li><input type="checkbox" id="checkbox8"><label for="checkbox8"></label><strong>Use reverse proxy</strong> (nginx, Apache) for additional security layer</li>
</ul>
<h3 id="112-network-security">11.2 Network Security</h3>
<p><strong>Recommended Architecture:</strong></p>
<pre class="hljs"><code><div>Internet
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Firewall       â”‚ (Allow only specific IPs/ports)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Reverse Proxy   â”‚ (nginx/Apache with SSL termination)
â”‚ (Port 443)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Biometric Serverâ”‚ (Internal network, port 8443)
â”‚ 127.0.0.1:8443  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</div></code></pre>
<p><strong>nginx Example Configuration:</strong></p>
<pre class="hljs"><code><div><span class="hljs-section">server</span> {
    <span class="hljs-attribute">listen</span> <span class="hljs-number">443</span> ssl http2;
    <span class="hljs-attribute">server_name</span> biometric.yourdomain.com;
    
    <span class="hljs-attribute">ssl_certificate</span> /etc/letsencrypt/live/yourdomain.com/fullchain.pem;
    <span class="hljs-attribute">ssl_certificate_key</span> /etc/letsencrypt/live/yourdomain.com/privkey.pem;
    
    <span class="hljs-comment"># Security headers</span>
    <span class="hljs-attribute">add_header</span> Strict-Transport-Security <span class="hljs-string">"max-age=31536000"</span> always;
    <span class="hljs-attribute">add_header</span> X-Frame-Options <span class="hljs-string">"DENY"</span> always;
    <span class="hljs-attribute">add_header</span> X-Content-Type-Options <span class="hljs-string">"nosniff"</span> always;
    
    <span class="hljs-comment"># Rate limiting</span>
    <span class="hljs-attribute">limit_req_zone</span> <span class="hljs-variable">$binary_remote_addr</span> zone=api:<span class="hljs-number">10m</span> rate=10r/s;
    <span class="hljs-attribute">limit_req</span> zone=api burst=<span class="hljs-number">20</span> nodelay;
    
    <span class="hljs-attribute">location</span> / {
        <span class="hljs-attribute">proxy_pass</span> https://127.0.0.1:8443;
        <span class="hljs-attribute">proxy_set_header</span> Host <span class="hljs-variable">$host</span>;
        <span class="hljs-attribute">proxy_set_header</span> X-Real-IP <span class="hljs-variable">$remote_addr</span>;
        <span class="hljs-attribute">proxy_set_header</span> X-Forwarded-For <span class="hljs-variable">$proxy_add_x_forwarded_for</span>;
        <span class="hljs-attribute">proxy_set_header</span> X-Forwarded-Proto <span class="hljs-variable">$scheme</span>;
    }
}
</div></code></pre>
<h3 id="113-database-security">11.3 Database Security</h3>
<p><strong>Encryption:</strong></p>
<ul>
<li>Database is encrypted using SQLCipher with AES-256</li>
<li>Encryption key stored in <code>.db_key</code> file</li>
<li><strong>âš ï¸ CRITICAL</strong>: Backup <code>.db_key</code> - without it, database cannot be decrypted</li>
</ul>
<p><strong>Access Control:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Restrict file permissions (Linux)</span>
chmod 600 biometric_system.db
chmod 600 .db_key
chmod 600 .jwt_secret
</div></code></pre>
<p><strong>Key Rotation</strong> (Advanced):</p>
<pre class="hljs"><code><div><span class="hljs-comment"># Generate new encryption key</span>
python -c <span class="hljs-string">"import secrets; print(secrets.token_urlsafe(32))"</span> &gt; .db_key.new

<span class="hljs-comment"># Re-encrypt database with new key (manual process - not automated)</span>
<span class="hljs-comment"># 1. Export all users</span>
<span class="hljs-comment"># 2. Delete database</span>
<span class="hljs-comment"># 3. Replace .db_key with .db_key.new</span>
<span class="hljs-comment"># 4. Re-import users</span>
</div></code></pre>
<h3 id="114-authentication-security">11.4 Authentication Security</h3>
<p><strong>Password Policy:</strong></p>
<ul>
<li>Minimum 8 characters (configurable in <code>config.py</code>)</li>
<li>Passwords hashed with bcrypt (cost factor 12)</li>
<li>No password reuse enforcement (implement externally if needed)</li>
</ul>
<p><strong>Token Security:</strong></p>
<ul>
<li>JWT tokens signed with HS256 algorithm</li>
<li>Secret key auto-generated on first run (stored in <code>.jwt_secret</code>)</li>
<li>Tokens include expiry timestamp</li>
<li>Stateless validation (no server-side session storage)</li>
</ul>
<p><strong>Best Practices:</strong></p>
<ul>
<li>Rotate admin passwords every 90 days</li>
<li>Use strong passwords (16+ characters, mixed case, numbers, symbols)</li>
<li>Never share credentials via insecure channels</li>
<li>Monitor <code>auth.log</code> for suspicious login patterns</li>
</ul>
<h3 id="115-template-security">11.5 Template Security</h3>
<p><strong>Storage Format:</strong></p>
<ul>
<li>Templates stored as <strong>Protected Hash + Minutiae</strong> (secure format)</li>
<li><strong>NO raw biometric data</strong> stored in database</li>
<li>Cancelable templates: Can be revoked by changing hash key</li>
</ul>
<p><strong>Template Protection:</strong></p>
<ul>
<li>Hash-based encoding with random projection</li>
<li>Projection key: <code>HASH_KEY</code> in <code>config.py</code></li>
<li>Changing key invalidates all templates (requires re-enrollment)</li>
</ul>
<p><strong>Privacy Compliance:</strong></p>
<ul>
<li>System stores only <strong>derived features</strong>, not raw images</li>
<li>GDPR compliant: Users can request deletion (delete user operation)</li>
<li>No biometric data leakage even if database is compromised</li>
</ul>
<h3 id="116-audit-trail">11.6 Audit Trail</h3>
<p><strong>Audit Logging:</strong></p>
<ul>
<li>All operations logged in <code>auth.log</code> and <code>biometric.log</code></li>
<li>Logs include: timestamp, user, IP address, action, result</li>
<li>Database audit table: <code>audit_log</code></li>
</ul>
<p><strong>View Audit Log:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># From admin dashboard</span>
Admin â†’ Audit Log (<span class="hljs-built_in">limit</span> 100 entries)

<span class="hljs-comment"># From database</span>
python -c <span class="hljs-string">"from src.webserver.database import BiometricDatabase; db = BiometricDatabase(); logs = db.get_audit_log(1000); [print(l) for l in logs]; db.close()"</span>
</div></code></pre>
<p><strong>Audit Events Tracked:</strong></p>
<ul>
<li>User authentication (login, logout, failures)</li>
<li>User management (create, update, delete)</li>
<li>Biometric operations (enroll, verify, identify)</li>
<li>Job execution (folder loading, batch operations)</li>
</ul>
<h3 id="117-vulnerability-management">11.7 Vulnerability Management</h3>
<p><strong>Keep System Updated:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Update Python dependencies</span>
pip list --outdated
pip install --upgrade &lt;package&gt;

<span class="hljs-comment"># Update entire system</span>
pip install -r requirements.txt --upgrade
</div></code></pre>
<p><strong>Security Scanning:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Check for known vulnerabilities in dependencies</span>
pip install safety
safety check

<span class="hljs-comment"># Check for outdated packages</span>
pip install pip-audit
pip-audit
</div></code></pre>
<p><strong>Regular Security Tasks:</strong></p>
<ul>
<li><input type="checkbox" id="checkbox9"><label for="checkbox9">Review logs weekly for anomalies</label></li>
<li><input type="checkbox" id="checkbox10"><label for="checkbox10">Update dependencies monthly</label></li>
<li><input type="checkbox" id="checkbox11"><label for="checkbox11">Rotate passwords quarterly</label></li>
<li><input type="checkbox" id="checkbox12"><label for="checkbox12">Test backups quarterly</label></li>
<li><input type="checkbox" id="checkbox13"><label for="checkbox13">Review rate limits and thresholds quarterly</label></li>
</ul>
<hr>
<h2 id="12-advanced-configuration">12. Advanced Configuration</h2>
<h3 id="121-multi-node-deployment">12.1 Multi-Node Deployment</h3>
<p>For high-availability setups with multiple servers:</p>
<p><strong>Architecture:</strong></p>
<pre class="hljs"><code><div>         Load Balancer (HAProxy/nginx)
                 â”‚
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚          â”‚          â”‚
   Server 1   Server 2   Server 3
      â”‚          â”‚          â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
        Shared Database
     (PostgreSQL + NFS mount)
</div></code></pre>
<p><strong>Considerations:</strong></p>
<ul>
<li>Shared database required (current: SQLite - single file)</li>
<li>Template cache must be synchronized across nodes</li>
<li>JWT secret must be identical on all nodes</li>
<li>Session affinity recommended for endpoint users</li>
</ul>
<p><strong>Migration Path:</strong></p>
<ol>
<li>Export current database to PostgreSQL</li>
<li>Update database connection in <code>database.py</code></li>
<li>Deploy multiple server instances</li>
<li>Configure load balancer</li>
</ol>
<h3 id="122-custom-thresholds-per-user">12.2 Custom Thresholds per User</h3>
<p>For specialized use cases (VIP users, high-security zones):</p>
<p><strong>Edit <code>database.py</code> to add threshold field:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Add column to fingerprints table</span>
threshold REAL DEFAULT <span class="hljs-number">0.75</span>
</div></code></pre>
<p><strong>Modify matching logic to use per-user threshold:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># In biometric_routes.py</span>
user_data = db.get_fingerprint(user_id)
custom_threshold = user_data.get(<span class="hljs-string">'threshold'</span>, VERIFICATION_THRESHOLD)
</div></code></pre>
<h3 id="123-external-authentication-ldapactive-directory">12.3 External Authentication (LDAP/Active Directory)</h3>
<p>For enterprise integration:</p>
<p><strong>Install LDAP library:</strong></p>
<pre class="hljs"><code><div>pip install ldap3
</div></code></pre>
<p><strong>Modify <code>auth.py</code> to add LDAP authentication:</strong></p>
<pre class="hljs"><code><div><span class="hljs-keyword">from</span> ldap3 <span class="hljs-keyword">import</span> Server, Connection, ALL

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">authenticate_ldap</span><span class="hljs-params">(username, password)</span>:</span>
    server = Server(<span class="hljs-string">'ldap://your-ldap-server.com'</span>, get_info=ALL)
    conn = Connection(server, user=<span class="hljs-string">f'cn=<span class="hljs-subst">{username}</span>,dc=company,dc=com'</span>, password=password)
    
    <span class="hljs-keyword">if</span> conn.bind():
        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>
    <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span>
</div></code></pre>
<h3 id="124-webhook-notifications">12.4 Webhook Notifications</h3>
<p>For integration with external systems:</p>
<p><strong>Add webhook configuration to <code>config.py</code>:</strong></p>
<pre class="hljs"><code><div>WEBHOOK_ENABLED = <span class="hljs-literal">True</span>
WEBHOOK_URL = <span class="hljs-string">"https://your-system.com/webhook"</span>
WEBHOOK_EVENTS = [<span class="hljs-string">"enroll"</span>, <span class="hljs-string">"verify"</span>, <span class="hljs-string">"identify"</span>]
</div></code></pre>
<p><strong>Implement webhook in <code>logger.py</code>:</strong></p>
<pre class="hljs"><code><div><span class="hljs-keyword">import</span> requests

<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">send_webhook</span><span class="hljs-params">(event, data)</span>:</span>
    <span class="hljs-keyword">if</span> WEBHOOK_ENABLED <span class="hljs-keyword">and</span> event <span class="hljs-keyword">in</span> WEBHOOK_EVENTS:
        <span class="hljs-keyword">try</span>:
            requests.post(WEBHOOK_URL, json={
                <span class="hljs-string">'event'</span>: event,
                <span class="hljs-string">'timestamp'</span>: datetime.utcnow().isoformat(),
                <span class="hljs-string">'data'</span>: data
            }, timeout=<span class="hljs-number">5</span>)
        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:
            log_error(e, context=<span class="hljs-string">"webhook"</span>)
</div></code></pre>
<hr>
<h2 id="13-api-reference-quick-guide">13. API Reference (Quick Guide)</h2>
<h3 id="131-authentication-endpoints">13.1 Authentication Endpoints</h3>
<p><strong>Login:</strong></p>
<pre class="hljs"><code><div>POST /api/login
Content-Type: application/json

{
  <span class="hljs-string">"login"</span>: <span class="hljs-string">"admin"</span>,
  <span class="hljs-string">"password"</span>: <span class="hljs-string">"your_password"</span>
}

Response:
{
  <span class="hljs-string">"token"</span>: <span class="hljs-string">"eyJhbGci..."</span>,
  <span class="hljs-string">"login"</span>: <span class="hljs-string">"admin"</span>,
  <span class="hljs-string">"privilege"</span>: <span class="hljs-string">"admin"</span>,
  <span class="hljs-string">"expires_in"</span>: 3600
}
</div></code></pre>
<p><strong>All subsequent requests require header:</strong></p>
<pre class="hljs"><code><div>Authorization: Bearer &lt;token&gt;
</div></code></pre>
<h3 id="132-user-management-endpoints">13.2 User Management Endpoints</h3>
<p><strong>List Users:</strong></p>
<pre class="hljs"><code><div>GET /api/users
Authorization: Bearer &lt;token&gt;

Response:
{
  <span class="hljs-string">"users"</span>: [
    {
      <span class="hljs-string">"user_id"</span>: <span class="hljs-string">"user001"</span>,
      <span class="hljs-string">"name"</span>: <span class="hljs-string">"John Doe"</span>,
      <span class="hljs-string">"quality"</span>: 0.85,
      <span class="hljs-string">"num_minutiae"</span>: 42,
      <span class="hljs-string">"created_at"</span>: <span class="hljs-string">"2025-01-15T14:23:45"</span>
    }
  ]
}
</div></code></pre>
<p><strong>Add User:</strong></p>
<pre class="hljs"><code><div>POST /api/users
Authorization: Bearer &lt;token&gt;
Content-Type: multipart/form-data

user_id: user001
name: John Doe
images: [file1.png, file2.png, file3.png, ...]

Response:
{
  <span class="hljs-string">"user_id"</span>: <span class="hljs-string">"user001"</span>,
  <span class="hljs-string">"quality"</span>: 0.85,
  <span class="hljs-string">"num_images"</span>: 5
}
</div></code></pre>
<p><strong>Delete User:</strong></p>
<pre class="hljs"><code><div>DELETE /api/users/{user_id}
Authorization: Bearer &lt;token&gt;

Response:
{
  <span class="hljs-string">"message"</span>: <span class="hljs-string">"User deleted successfully"</span>,
  <span class="hljs-string">"user_id"</span>: <span class="hljs-string">"user001"</span>
}
</div></code></pre>
<h3 id="133-biometric-operations">13.3 Biometric Operations</h3>
<p><strong>Verify (1:1):</strong></p>
<pre class="hljs"><code><div>POST /api/verify
Authorization: Bearer &lt;token&gt;
Content-Type: multipart/form-data

user_id: user001
image: probe.png

Response:
{
  <span class="hljs-string">"match"</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-string">"score"</span>: 0.82,
  <span class="hljs-string">"hash_score"</span>: 0.78,
  <span class="hljs-string">"geometric_score"</span>: 0.88,
  <span class="hljs-string">"user_id"</span>: <span class="hljs-string">"user001"</span>,
  <span class="hljs-string">"threshold"</span>: 0.75,
  <span class="hljs-string">"num_matched"</span>: 34
}
</div></code></pre>
<p><strong>Identify (1:N):</strong></p>
<pre class="hljs"><code><div>POST /api/identify
Authorization: Bearer &lt;token&gt;
Content-Type: multipart/form-data

image: probe.png

Response:
{
  <span class="hljs-string">"identified"</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-string">"best_match_id"</span>: <span class="hljs-string">"user001"</span>,
  <span class="hljs-string">"best_score"</span>: 0.82,
  <span class="hljs-string">"matches"</span>: [
    {<span class="hljs-string">"user_id"</span>: <span class="hljs-string">"user001"</span>, <span class="hljs-string">"score"</span>: 0.82},
    {<span class="hljs-string">"user_id"</span>: <span class="hljs-string">"user042"</span>, <span class="hljs-string">"score"</span>: 0.45}
  ],
  <span class="hljs-string">"total_users"</span>: 42,
  <span class="hljs-string">"threshold"</span>: 0.70
}
</div></code></pre>
<h3 id="134-admin-endpoints">13.4 Admin Endpoints</h3>
<p><strong>Load Folder:</strong></p>
<pre class="hljs"><code><div>POST /api/admin/load_folder
Authorization: Bearer &lt;token&gt;
Content-Type: multipart/form-data

folder_path: /path/to/fingerprints

Response:
{
  <span class="hljs-string">"job_id"</span>: <span class="hljs-string">"550e8400-e29b-41d4-a716-446655440000"</span>,
  <span class="hljs-string">"message"</span>: <span class="hljs-string">"Background job started"</span>
}
</div></code></pre>
<p><strong>Get Job Status:</strong></p>
<pre class="hljs"><code><div>GET /api/admin/<span class="hljs-built_in">jobs</span>/{job_id}
Authorization: Bearer &lt;token&gt;

Response:
{
  <span class="hljs-string">"id"</span>: <span class="hljs-string">"550e8400-..."</span>,
  <span class="hljs-string">"type"</span>: <span class="hljs-string">"load_folder"</span>,
  <span class="hljs-string">"status"</span>: <span class="hljs-string">"completed"</span>,
  <span class="hljs-string">"result"</span>: <span class="hljs-string">"{\"enrolled\": 42, \"failed\": 3}"</span>,
  <span class="hljs-string">"started_at"</span>: <span class="hljs-string">"2025-01-15T14:23:45"</span>,
  <span class="hljs-string">"completed_at"</span>: <span class="hljs-string">"2025-01-15T14:28:12"</span>
}
</div></code></pre>
<p><strong>Get Statistics:</strong></p>
<pre class="hljs"><code><div>GET /api/admin/stats
Authorization: Bearer &lt;token&gt;

Response:
{
  <span class="hljs-string">"num_users"</span>: 42,
  <span class="hljs-string">"avg_template_quality"</span>: 0.85,
  <span class="hljs-string">"total_minutiae"</span>: 1764,
  <span class="hljs-string">"encrypted"</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-string">"cached_templates"</span>: 42,
  <span class="hljs-string">"running_jobs"</span>: 0
}
</div></code></pre>
<hr>
<h2 id="14-faq">14. FAQ</h2>
<p><strong>Q: How many users can the system handle?</strong></p>
<p>A: Tested with up to 10,000 users. Performance:</p>
<ul>
<li>Enrollment: ~2-5 seconds per user</li>
<li>Verification (1:1): ~2-3 seconds</li>
<li>Identification (1:N):
<ul>
<li>100 users: ~3-5 seconds</li>
<li>1,000 users: ~10-20 seconds (with parallel processing)</li>
<li>10,000 users: ~60-120 seconds</li>
</ul>
</li>
</ul>
<p><strong>Q: Can I use the system offline?</strong></p>
<p>A: Yes, the system is fully self-contained and requires no internet connection. All processing is done locally.</p>
<p><strong>Q: What image formats are supported?</strong></p>
<p>A: PNG, JPG/JPEG, TIF/TIFF, BMP. TIF format recommended for fingerprint databases.</p>
<p><strong>Q: Can I integrate with my existing application?</strong></p>
<p>A: Yes, use the REST API documented in Section 13. The API is language-agnostic (works with Python, JavaScript, Java, C#, etc.).</p>
<p><strong>Q: Is the system GDPR compliant?</strong></p>
<p>A: Yes, when properly configured:</p>
<ul>
<li>Only derived features stored (not raw biometrics)</li>
<li>Users can request deletion (delete user operation)</li>
<li>Audit logging tracks all data access</li>
<li>Templates are cancelable (can be revoked)</li>
</ul>
<p><strong>Q: What happens if I lose the encryption key (.db_key)?</strong></p>
<p>A: <strong>Database cannot be recovered.</strong> The encryption key is critical - back it up securely and separately from the database.</p>
<p><strong>Q: Can I change the hash key after enrollment?</strong></p>
<p>A: No, changing <code>HASH_KEY</code> invalidates all templates. Users must be re-enrolled. Plan key management before production deployment.</p>
<p><strong>Q: How do I upgrade to a new version?</strong></p>
<p>A:</p>
<ol>
<li>Backup database and configuration</li>
<li>Stop server</li>
<li>Update code files</li>
<li>Run <code>pip install -r requirements.txt --upgrade</code></li>
<li>Test in development environment first</li>
<li>Deploy to production</li>
</ol>
<p><strong>Q: What if the server crashes during enrollment?</strong></p>
<p>A: Partial enrollments are rolled back automatically. The user will not be added to the database. Simply retry the enrollment.</p>
<hr>
<h2 id="15-support-and-maintenance">15. Support and Maintenance</h2>
<h3 id="151-log-review-schedule">15.1 Log Review Schedule</h3>
<p><strong>Daily:</strong></p>
<ul>
<li>Check <code>error.log</code> for exceptions</li>
<li>Monitor failed authentication attempts in <code>auth.log</code></li>
</ul>
<p><strong>Weekly:</strong></p>
<ul>
<li>Review <code>biometric.log</code> for usage patterns</li>
<li>Check system health: <code>/health</code> endpoint</li>
<li>Verify backup completion</li>
</ul>
<p><strong>Monthly:</strong></p>
<ul>
<li>Analyze performance metrics</li>
<li>Review and adjust rate limits if needed</li>
<li>Update dependencies</li>
</ul>
<p><strong>Quarterly:</strong></p>
<ul>
<li>Full system audit</li>
<li>Password rotation</li>
<li>Backup restore test</li>
<li>Security scan</li>
</ul>
<h3 id="152-performance-tuning">15.2 Performance Tuning</h3>
<p><strong>For High-Volume Systems (1000+ verifications/day):</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># config.py</span>
MAX_WORKERS = <span class="hljs-number">8</span>                    <span class="hljs-comment"># Increase workers</span>
CACHE_ENABLED = <span class="hljs-literal">True</span>               <span class="hljs-comment"># Ensure caching enabled</span>
FUSION_ENABLED = <span class="hljs-literal">True</span>              <span class="hljs-comment"># Better accuracy</span>
VERIFICATION_THRESHOLD = <span class="hljs-number">0.75</span>      <span class="hljs-comment"># Maintain security</span>

<span class="hljs-comment"># Rate limits - adjust based on usage</span>
RATE_LIMITS = {
    <span class="hljs-string">"verify"</span>: (<span class="hljs-number">30</span>, <span class="hljs-number">60</span>),            <span class="hljs-comment"># 30 per minute</span>
    <span class="hljs-string">"identify"</span>: (<span class="hljs-number">10</span>, <span class="hljs-number">60</span>),          <span class="hljs-comment"># 10 per minute</span>
}
</div></code></pre>
<p><strong>For Low-Resource Systems (limited CPU/RAM):</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># config.py</span>
MAX_WORKERS = <span class="hljs-number">2</span>                    <span class="hljs-comment"># Reduce workers</span>
CACHE_ENABLED = <span class="hljs-literal">True</span>               <span class="hljs-comment"># Keep for speed</span>
USE_CPU_AFFINITY = <span class="hljs-literal">False</span>           <span class="hljs-comment"># Disable affinity</span>
</div></code></pre>
<h3 id="153-disaster-recovery">15.3 Disaster Recovery</h3>
<p><strong>Scenario: Database Corruption</strong></p>
<ol>
<li>Stop server immediately</li>
<li>Restore from last backup:<pre class="hljs"><code><div>cp backups/latest/biometric_system.db .
cp backups/latest/.db_key .
</div></code></pre>
</li>
<li>Start server and verify user count</li>
<li>If corruption recent, use transaction log recovery (if available)</li>
</ol>
<p><strong>Scenario: Server Hardware Failure</strong></p>
<ol>
<li>Install system on new hardware</li>
<li>Restore all files from backup:
<ul>
<li><code>biometric_system.db</code></li>
<li><code>.db_key</code></li>
<li><code>.jwt_secret</code></li>
<li><code>certs/</code></li>
</ul>
</li>
<li>Install dependencies: <code>pip install -r requirements.txt</code></li>
<li>Start server and verify functionality</li>
</ol>
<p><strong>Scenario: Accidental User Deletion</strong></p>
<ol>
<li>Stop server</li>
<li>Restore database from backup:<pre class="hljs"><code><div>cp backups/before_deletion/biometric_system.db .
</div></code></pre>
</li>
<li>Start server</li>
<li><strong>Note</strong>: Any enrollments after backup are lost</li>
</ol>
<hr>
<h2 id="16-appendix">16. Appendix</h2>
<h3 id="161-configuration-file-template">16.1 Configuration File Template</h3>
<p>Save as <code>config.py</code> for reference:</p>
<pre class="hljs"><code><div><span class="hljs-string">"""WebServer Configuration - Production Template"""</span>

<span class="hljs-comment"># NETWORK</span>
HOST = <span class="hljs-string">"0.0.0.0"</span>
PORT_HTTPS = <span class="hljs-number">8443</span>
PORT_HTTP = <span class="hljs-number">8080</span>
CORS_ORIGINS = [<span class="hljs-string">"https://yourdomain.com"</span>]

<span class="hljs-comment"># AUTHENTICATION</span>
JWT_EXPIRY_ADMIN_HOURS = <span class="hljs-number">1</span>
JWT_EXPIRY_ENDPOINT_HOURS = <span class="hljs-number">12</span>
MAX_LOGIN_ATTEMPTS = <span class="hljs-number">5</span>
LOCKOUT_DURATION_MINUTES = <span class="hljs-number">15</span>

<span class="hljs-comment"># BIOMETRIC THRESHOLDS</span>
QUALITY_THRESHOLD = <span class="hljs-number">0.30</span>
VERIFICATION_THRESHOLD = <span class="hljs-number">0.75</span>
IDENTIFICATION_THRESHOLD = <span class="hljs-number">0.70</span>

<span class="hljs-comment"># ENROLLMENT</span>
MIN_SAMPLES_PER_USER = <span class="hljs-number">2</span>
MAX_SAMPLES_PER_USER = <span class="hljs-number">10</span>
RECOMMENDED_SAMPLES = <span class="hljs-number">5</span>

<span class="hljs-comment"># FUSION</span>
FUSION_ENABLED = <span class="hljs-literal">True</span>
FUSION_DISTANCE = <span class="hljs-number">12.0</span>
FUSION_ANGLE_DEG = <span class="hljs-number">15.0</span>
FUSION_MIN_CONSENSUS = <span class="hljs-number">0.5</span>
FUSION_MODE = <span class="hljs-string">"optimal"</span>

<span class="hljs-comment"># MULTIPROCESSING</span>
MAX_WORKERS = <span class="hljs-number">4</span>
USE_CPU_AFFINITY = <span class="hljs-literal">True</span>
PCORES = list(range(<span class="hljs-number">0</span>, <span class="hljs-number">12</span>))

<span class="hljs-comment"># RATE LIMITING</span>
RATE_LIMITS = {
    <span class="hljs-string">"login"</span>: (<span class="hljs-number">5</span>, <span class="hljs-number">300</span>),
    <span class="hljs-string">"verify"</span>: (<span class="hljs-number">10</span>, <span class="hljs-number">60</span>),
    <span class="hljs-string">"identify"</span>: (<span class="hljs-number">5</span>, <span class="hljs-number">60</span>),
    <span class="hljs-string">"enroll"</span>: (<span class="hljs-number">20</span>, <span class="hljs-number">3600</span>),
}

<span class="hljs-comment"># LOGGING</span>
LOG_MAX_BYTES = <span class="hljs-number">10</span> * <span class="hljs-number">1024</span> * <span class="hljs-number">1024</span>
LOG_BACKUP_COUNT = <span class="hljs-number">5</span>
VERBOSE = <span class="hljs-literal">True</span>
</div></code></pre>
<h3 id="162-command-reference">16.2 Command Reference</h3>
<p><strong>Server Management:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Start server</span>
python run_webserver.py

<span class="hljs-comment"># Start with custom settings</span>
python run_webserver.py --host 0.0.0.0 --port 8443 --ssl

<span class="hljs-comment"># Reset admin password</span>
python run_webserver.py --reset-admin

<span class="hljs-comment"># Use more workers</span>
python run_webserver.py --workers 8
</div></code></pre>
<p><strong>Database Operations:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># View user count</span>
python -c <span class="hljs-string">"from src.webserver.database import BiometricDatabase; db = BiometricDatabase(); print(f'Users: {len(db.list_fingerprints())}'); db.close()"</span>

<span class="hljs-comment"># View statistics</span>
python -c <span class="hljs-string">"from src.webserver.database import BiometricDatabase; db = BiometricDatabase(); print(db.get_stats()); db.close()"</span>

<span class="hljs-comment"># Export users list</span>
python -c <span class="hljs-string">"from src.webserver.database import BiometricDatabase; import json; db = BiometricDatabase(); print(json.dumps(db.list_fingerprints(), indent=2)); db.close()"</span> &gt; users.json
</div></code></pre>
<p><strong>Log Operations:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># View recent errors</span>
tail -n 50 logs/error.log

<span class="hljs-comment"># Search for user</span>
grep <span class="hljs-string">"user001"</span> logs/biometric.log

<span class="hljs-comment"># Count operations</span>
grep <span class="hljs-string">"VERIFY"</span> logs/biometric.log | wc -l
</div></code></pre>
<h3 id="163-glossary">16.3 Glossary</h3>
<ul>
<li><strong>Enrollment</strong>: Process of capturing and storing a user's fingerprint template</li>
<li><strong>Template</strong>: Derived biometric features stored in database (NOT raw image)</li>
<li><strong>Verification (1:1)</strong>: Confirming claimed identity against enrolled template</li>
<li><strong>Identification (1:N)</strong>: Finding match in database for unknown fingerprint</li>
<li><strong>Quality Score</strong>: Metric (0.0-1.0) indicating template reliability</li>
<li><strong>Threshold</strong>: Minimum score required for positive match</li>
<li><strong>Minutiae</strong>: Ridge ending/bifurcation points in fingerprint</li>
<li><strong>Fusion</strong>: Combining multiple samples into master template</li>
<li><strong>Protected Hash</strong>: Cancelable template encoding for security</li>
<li><strong>JWT</strong>: JSON Web Token for stateless authentication</li>
<li><strong>Rate Limiting</strong>: Restricting request frequency to prevent abuse</li>
</ul>
<hr>
<h2 id="document-information">Document Information</h2>
<p><strong>Document Version</strong>: 1.0.0<br>
<strong>Last Updated</strong>: November 2025<br>
<strong>System Version</strong>: Supermatcher 1.0.0<br>
<strong>Author</strong>: System Administrator Guide</p>
<p><strong>Revision History:</strong></p>
<ul>
<li>v1.0.0 (2025-11): Initial release</li>
</ul>
<hr>
<p><strong>End of Administrator Manual</strong></p>
<p>For technical support or questions, consult the system logs or contact your system integrator.</p>

</body>
</html>
